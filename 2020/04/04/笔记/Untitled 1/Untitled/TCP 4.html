<h1 id="TCP连接的建立"><a href="#TCP连接的建立" class="headerlink" title="TCP连接的建立"></a>TCP连接的建立</h1><h1 id="TCP标记"><a href="#TCP标记" class="headerlink" title="TCP标记"></a>TCP标记</h1><p><img src="TCP%204/Untitled.png" alt="TCP%204/Untitled.png"></p>
<p>与三次握手相关联的三个重要标记</p>
<ul>
<li>ACK =1，确认号生效</li>
<li>SYN =1 连接请求</li>
<li>FIN</li>
</ul>
<p><img src="TCP%204/Untitled%201.png" alt="TCP%204/Untitled%201.png"></p>
<h1 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h1><h2 id="总过程"><a href="#总过程" class="headerlink" title="总过程"></a>总过程</h2><ul>
<li>发送方2次k握手进入连接状态</li>
<li>接收方3次握手进入连接状态</li>
<li>第二次和第三次都有ACK的标记</li>
</ul>
<p>SYN=1，seq =x，序列号=x；</p>
<p>SYN=1，ACK =1 和确认号一起，seq=y自己的序列号，ack =x+1，确认号，期待收到<strong>序列号x+1的报文</strong></p>
<p>没有SYN，ACK=1，确认号有用，seq=x+1，ack=y+1，</p>
<h3 id="状态"><a href="#状态" class="headerlink" title="状态"></a>状态</h3><ul>
<li><p>发送方两次握手之后建立连接状态</p>
</li>
<li><p>接收方三次握手之后建立连接状态</p>
<p>  <img src="TCP%204/Untitled%202.png" alt="TCP%204/Untitled%202.png"></p>
</li>
</ul>
<h2 id="为什么发送方要发送第三个确认报文？"><a href="#为什么发送方要发送第三个确认报文？" class="headerlink" title="为什么发送方要发送第三个确认报文？"></a>为什么发送方要发送第三个确认报文？</h2><blockquote>
<p>避免已经<strong>失效的连接请求报文</strong>传送到对方，<strong>引起错误</strong></p>
</blockquote>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><ul>
<li><p>发送方是连接请求的一方</p>
</li>
<li><p>假设发送方在网络中传输了很久，又发送了一个请求报文先到，早先发送的就成了失效的请求报文</p>
<p>  <img src="TCP%204/Untitled%203.png" alt="TCP%204/Untitled%203.png"></p>
</li>
<li><p>只要建立了第三次握手就会忽略因为网络延迟导致的握手</p>
</li>
</ul>
<p><img src="TCP%204/Untitled%204.png" alt="TCP%204/Untitled%204.png"></p>
<p><img src="TCP%204/Untitled%205.png" alt="TCP%204/Untitled%205.png"></p>
